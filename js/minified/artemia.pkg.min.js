var artemia=function(){var c={Interface:{storeType:"",storeName:"",isAvailable:function(){},get:function(){},remove:function(){},save:function(){},all:function(){},drop:function(){}}};c.interfaceIsImplemented=function(a){for(var b in c.Interface)if(c.Interface.hasOwnProperty(b))if(a[b]){if(typeof c.Interface[b]!==typeof a[b])throw"artemia : "+a.storeType+" Storage : '"+b+"' ("+typeof a[b]+") : bad type";}else throw"artemia : "+a.storeType+" Storage : '"+b+"' method is missing";};c.getStore=function(a){var b=
c["get_"+a.type.toUpperCase()+"_store"](a.base,a.type,a.domain);c.interfaceIsImplemented(b);b.query=function(b,d){var f=[],e;this.all(function(g){for(var a in g)g.hasOwnProperty(a)&&(e=b(g[a]))&&f.push(e);d&&d(f)});return a.type!="sqlite"?{sum:function(b){e=c.sum(f);b&&b(e);return e},min:function(b){e=c.min(f);b&&b(e);return e},max:function(b){e=c.max(f);b&&b(e);return e},product:function(b){e=c.product(f);b&&b(e);return e}}:null};return b};c.allDbs=function(){};c.guidGenerator=function(){var a=function(){return((1+
Math.random())*65536|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};c.sum=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&(c+=a[b]);return c};c.product=function(a){var b,c=1;for(b in a)a.hasOwnProperty(b)&&(c*=a[b]);return c};c.min=function(a){return Math.min.apply(Math,a)};c.max=function(a){return Math.max.apply(Math,a)};return c}();artemia=function(c){function a(b,a,d){return{storeType:d,storeName:a,isAvailable:function(){try{b.setItem("testKey","testValue"),b.removeItem("testKey")}catch(f){return!1}return!0},get:function(f,e){var a=JSON.parse(b.getItem(this.storeName+"|"+f));a?(a.key=f,e(a)):e(null)},remove:function(a,e){var d=this.storeName+"|"+(typeof a==="string"?a:a.key);b.removeItem(d);e&&e(d)},save:function(a,e){var d=this.storeName+"|"+(a.key||c.guidGenerator());delete a.key;b.setItem(d,JSON.stringify(a));a.key=d.split("|")[1];
e(a)},all:function(a){var d=[],c,h=b.length,i,k,j;for(c=0;c<h;c+=1)if(i=b.key(c),j=i.split("|")[0],k=i.split("|").slice(1).join("|"),j===this.storeName)i=JSON.parse(b.getItem(i)),i.key=k,d.push(i);a(d)},drop:function(a){var b=this;this.all(function(a){for(var d in a)a.hasOwnProperty(d)&&b.remove(a[d].key,null)});a&&a()}}}c.get_SESSION_store=function(b,c){var d=a(window.sessionStorage,b,c);d.isAvailable()||(d=null);return d};c.get_LOCAL_store=function(b,c){var d=a(window.localStorage,b,c);d.isAvailable()||
(d=null);return d};c.get_GLOBAL_store=function(b,c,d){b=a(window.globalStorage[d],b,c);b.isAvailable()||(b=null);return b};return c}(artemia);artemia=function(c){function a(a,l){return{storeType:l,storeName:a,dataBase:null,isAvailable:function(){try{var d=this;artemia[a]||(artemia[a]=window.openDatabase("Artemia","1.0","ARTEMIADB",65536));this.dataBase=artemia[a];this.dataBase.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS  "+d.storeName+"(UniqueId TEXT UNIQUE PRIMARY KEY,SerializedObject TEXT)",[],null,null)})}catch(c){if(c===2)throw"Invalid database version";else throw"Unknown error "+c;}return!0},save:function(a,b){var e,
g,h=this;e=function(a,b){h.dataBase.transaction(function(c){c.executeSql("UPDATE "+h.storeName+" SET SerializedObject = ? WHERE UniqueId = ?;",[JSON.stringify(a),a.key],b(a),null)})};g=function(a,b){h.dataBase.transaction(function(d){if(!a.key)a.key=c.guidGenerator();d.executeSql("INSERT INTO "+h.storeName+" (UniqueId, SerializedObject) VALUES (?, ?);",[a.key,JSON.stringify(a)],b(a),null)})};a.key===void 0?g(a,b):this.get(a.key,function(c){c===null?g(a,b):e(a,b)})},get:function(a,b){var c=this;c.dataBase.transaction(function(g){g.executeSql("SELECT SerializedObject FROM "+
c.storeName+" WHERE UniqueId= ?;",[a],function(a,c){var d={},d=c.rows.length>0?JSON.parse(c.rows.item(0).SerializedObject):null;b(d)},function(){})})},remove:function(a,b){var c=this;c.database.transaction(function(g){var h=typeof a==="string"?a:a.key;g.executeSql("DELETE FROM "+c.storeName+" WHERE UniqueId= ?;",h,function(){b(h)},function(){})})},all:function(a){var b=this;b.dataBase.transaction(function(c){c.executeSql("SELECT * FROM "+b.storeName+";",[],function(b,c){var e=[],f={},j;for(j=c.rows.length;j--;)f=
c.rows.item(j),f=JSON.parse(f.SerializedObject),e.push(f);a(e)},function(){})})},nuke:function(a){var b=this;b.dataBase.transaction(function(c){c.executeSql("DELETE FROM "+b.storeName+";",[],function(){a()},function(){})})},drop:function(a){var b=this;b.dataBase.transaction(function(c){c.executeSql("DROP TABLE "+b.storeName+";",[],function(){a()},function(){})})}}}c.get_SQLITE_store=function(b,c){var d=a(b,c);d.isAvailable()||(d=null);return d};return c}(artemia);